<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.14.0" xml:lang="en-US">
  <compounddef id="dust__physics_8c" kind="file" language="C++">
    <compoundname>dust_physics.c</compoundname>
    <includes refid="dust__physics_8h" local="yes">dust_physics.h</includes>
    <includes refid="config_8h" local="yes">config.h</includes>
    <includes refid="simulation__types_8h" local="yes">simulation_types.h</includes>
    <includes refid="globals_8h" local="yes">globals.h</includes>
    <includes refid="simulation__core_8h" local="yes">simulation_core.h</includes>
    <includes refid="utils_8h" local="yes">utils.h</includes>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">math.h</includes>
    <includes local="no">omp.h</includes>
    <incdepgraph>
      <node id="2">
        <label>config.h</label>
        <link refid="config_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c</label>
        <link refid="dust__physics_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>math.h</label>
      </node>
      <node id="6">
        <label>omp.h</label>
      </node>
      <node id="3">
        <label>stdio.h</label>
      </node>
      <node id="5">
        <label>stdlib.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="func">
      <memberdef kind="function" id="dust__physics_8c_1aab686a08857e54fbce70994310f0ec8d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double calculate_turbulent_alpha</definition>
        <argsstring>(double r, const disk_t *disk_params)</argsstring>
        <name>calculate_turbulent_alpha</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="21" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="21" bodyend="25"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a641fdcc93641aa597ec4f299cea491ff" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double Stokes_Number</definition>
        <argsstring>(double pradius, double sigma, disk_t *disk_params)</argsstring>
        <name>Stokes_Number</name>
        <param>
          <type>double</type>
          <declname>pradius</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="29" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="29" bodyend="31"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a497aa236e223bbee58bcf2553e282110" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double visc</definition>
        <argsstring>(double r, const disk_t *disk_params)</argsstring>
        <name>visc</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="34" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="34" bodyend="43"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a143c0cce5ab99242fe3a8f12fe684064" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double scale_height</definition>
        <argsstring>(double r, const disk_t *disk_params)</argsstring>
        <name>scale_height</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="46" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="46" bodyend="56"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a42f6f4c484c4fb4cff9b930856f47056" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double v_kep</definition>
        <argsstring>(double r, const disk_t *disk_params)</argsstring>
        <name>v_kep</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="59" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="59" bodyend="61"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a1200b3706ca6224cb56ef9e4b8c1e9bb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double kep_freq</definition>
        <argsstring>(double r, const disk_t *disk_params)</argsstring>
        <name>kep_freq</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="64" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="64" bodyend="66"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a98e9e3efafb56031b76f695f8535ea04" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double c_sound</definition>
        <argsstring>(double r, const disk_t *disk_params)</argsstring>
        <name>c_sound</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="69" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="69" bodyend="71"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a50257c15f2d864a7b6ab0436c87f4fe3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double rho_mp</definition>
        <argsstring>(double sigma, double r, const disk_t *disk_params)</argsstring>
        <name>rho_mp</name>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="74" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="74" bodyend="76"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a6ce849c548e4c7025fa6986c3575d0f6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double press</definition>
        <argsstring>(double sigma, double r, const disk_t *disk_params)</argsstring>
        <name>press</name>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="79" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="79" bodyend="81"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a243b2215e047eef1da966f153174d456" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void dpress</definition>
        <argsstring>(disk_t *disk_params)</argsstring>
        <name>dpress</name>
        <param>
          <type>disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="84" column="6" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="84" bodyend="98"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a00f0a0d1089c16d462119216119cc474" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double Coeff_3</definition>
        <argsstring>(double sigma, double r)</argsstring>
        <name>Coeff_3</name>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="101" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="101" bodyend="103"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1ac15e4c8027b2c63491e7e620cb118aa0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void u_gas</definition>
        <argsstring>(disk_t *disk_params)</argsstring>
        <name>u_gas</name>
        <param>
          <type>disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="106" column="6" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="106" bodyend="137"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1afcfa755bb81e26ac64d0efaf0ddf0b15" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void GetMass</definition>
        <argsstring>(int n, double(*partmassind)[5], int indii, int indio, int indoi, int indoo, double *massiout, double *massoout, const simulation_options_t *sim_opts)</argsstring>
        <name>GetMass</name>
        <param>
          <type>int</type>
          <declname>n</declname>
        </param>
        <param>
          <type>double(*)</type>
          <declname>partmassind</declname>
          <array>[5]</array>
        </param>
        <param>
          <type>int</type>
          <declname>indii</declname>
        </param>
        <param>
          <type>int</type>
          <declname>indio</declname>
        </param>
        <param>
          <type>int</type>
          <declname>indoi</declname>
        </param>
        <param>
          <type>int</type>
          <declname>indoo</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>massiout</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>massoout</declname>
        </param>
        <param>
          <type>const simulation_options_t *</type>
          <declname>sim_opts</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="141" column="6" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="141" bodyend="207"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1adc332f0b34daefd2eb5e9c8aec014738" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double a_drift</definition>
        <argsstring>(double sigmad, double r, double p, double dp, double rho_p, const disk_t *disk_params)</argsstring>
        <name>a_drift</name>
        <param>
          <type>double</type>
          <declname>sigmad</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>double</type>
          <declname>p</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rho_p</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="214" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="214" bodyend="225"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1aeb4b349dde1c5e63d9e26d88b230e86b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double a_turb</definition>
        <argsstring>(double sigma, double r, double rho_p, const disk_t *disk_params)</argsstring>
        <name>a_turb</name>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rho_p</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="228" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="228" bodyend="241"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1ac67bfb2ab2850f3920ec3054db0fd2b6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double a_df</definition>
        <argsstring>(double sigma, double r, double p, double dp, double rho_p, const disk_t *disk_params)</argsstring>
        <name>a_df</name>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>double</type>
          <declname>p</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dp</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rho_p</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="244" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="244" bodyend="258"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a3dc62ab38a32eb7fbdeecfe308dffdcb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double tauGr</definition>
        <argsstring>(double r, double eps, const disk_t *disk_params)</argsstring>
        <name>tauGr</name>
        <param>
          <type>double</type>
          <declname>r</declname>
        </param>
        <param>
          <type>double</type>
          <declname>eps</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="261" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="261" bodyend="265"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1af34fe8811318bddd22d0df4ea8dd3d7a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double getSize</definition>
        <argsstring>(double prad, double pdens, double sigma, double sigmad, double y, double p, double dpress_val, double dt, const disk_t *disk_params)</argsstring>
        <name>getSize</name>
        <param>
          <type>double</type>
          <declname>prad</declname>
        </param>
        <param>
          <type>double</type>
          <declname>pdens</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigmad</declname>
        </param>
        <param>
          <type>double</type>
          <declname>y</declname>
        </param>
        <param>
          <type>double</type>
          <declname>p</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dpress_val</declname>
        </param>
        <param>
          <type>double</type>
          <declname>dt</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="268" column="8" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="268" bodyend="289"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a7135420812061b53d78ed5cc0a08e814" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void Get_Sigmad</definition>
        <argsstring>(double max_param, double min_param, double rad[][2], double radmicr[][2], double *sigma_d, double *sigma_dm, double *massvec, double *massmicrvec, double *rd, double *rmic, const simulation_options_t *sim_opts, const disk_t *disk_params)</argsstring>
        <name>Get_Sigmad</name>
        <param>
          <type>double</type>
          <declname>max_param</declname>
        </param>
        <param>
          <type>double</type>
          <declname>min_param</declname>
        </param>
        <param>
          <type>double</type>
          <declname>rad</declname>
          <array>[][2]</array>
        </param>
        <param>
          <type>double</type>
          <declname>radmicr</declname>
          <array>[][2]</array>
        </param>
        <param>
          <type>double *</type>
          <declname>sigma_d</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>sigma_dm</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>massvec</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>massmicrvec</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>rd</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>rmic</declname>
        </param>
        <param>
          <type>const simulation_options_t *</type>
          <declname>sim_opts</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="294" column="6" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="294" bodyend="346"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1a9cfe37e0ef829a34d96a26b2ad52ebc6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void Get_Sigma_P_dP</definition>
        <argsstring>(const simulation_options_t *sim_opts, disk_t *disk_params)</argsstring>
        <name>Get_Sigma_P_dP</name>
        <param>
          <type>const simulation_options_t *</type>
          <declname>sim_opts</declname>
        </param>
        <param>
          <type>disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="350" column="6" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="350" bodyend="405"/>
      </memberdef>
      <memberdef kind="function" id="dust__physics_8c_1ab00360c4980cb1e84728ae1d447301ab" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void Get_Radius</definition>
        <argsstring>(const char *nev, int opt, double radius[][2], const double *sigmad, const double *rdvec, double deltat, double t, int n, const simulation_options_t *sim_opts, const disk_t *disk_params)</argsstring>
        <name>Get_Radius</name>
        <param>
          <type>const char *</type>
          <declname>nev</declname>
        </param>
        <param>
          <type>int</type>
          <declname>opt</declname>
        </param>
        <param>
          <type>double</type>
          <declname>radius</declname>
          <array>[][2]</array>
        </param>
        <param>
          <type>const double *</type>
          <declname>sigmad</declname>
        </param>
        <param>
          <type>const double *</type>
          <declname>rdvec</declname>
        </param>
        <param>
          <type>double</type>
          <declname>deltat</declname>
        </param>
        <param>
          <type>double</type>
          <declname>t</declname>
        </param>
        <param>
          <type>int</type>
          <declname>n</declname>
        </param>
        <param>
          <type>const simulation_options_t *</type>
          <declname>sim_opts</declname>
        </param>
        <param>
          <type>const disk_t *</type>
          <declname>disk_params</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" line="408" column="6" bodyfile="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c" bodystart="408" bodyend="482"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>src/dust_physics.c</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;dust_physics.h&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">//<sp/>A<sp/>saját<sp/>headerjét<sp/>mindig<sp/>includolni<sp/>kell</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="config_8h" kindref="compound">config.h</ref>&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Szükséges<sp/>lehet<sp/>a<sp/>globális<sp/>konstansokhoz<sp/>(pl.<sp/>PARTICLE_NUMBER,<sp/>AU2CM,<sp/>RMIN,<sp/>RMAX,<sp/>NGRID,<sp/>G_GRAV_CONST,<sp/>STAR,<sp/>SDCONV,<sp/>CMPSECTOAUPYRP2PI,<sp/>uFrag,<sp/>fFrag,<sp/>PDENSITYDIMLESS,<sp/>HASP,<sp/>M_PI,<sp/>DD,<sp/>sim_opts-&gt;dzone,<sp/>sim_opts-&gt;twopop,<sp/>RMIN,<sp/>RMAX,<sp/>FLIND,<sp/>alpha_visc,<sp/>a_mod,<sp/>r_dze_i,<sp/>r_dze_o,<sp/>Dr_dze_i,<sp/>Dr_dze_o)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;simulation_types.h&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">//<sp/>Például<sp/>output_files_t,<sp/>disk_t<sp/>struktúrákhoz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;globals.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;simulation_core.h&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">//<sp/>int_step,<sp/>Perem,<sp/>find_num_zero,<sp/>find_zero,<sp/>find_r_annulus<sp/>függvényekhez</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;utils.h&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>find_min<sp/>függvényhez</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;omp.h&gt;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>OpenMP<sp/>támogatáshoz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Globális<sp/>változó<sp/>deklarációk,<sp/>ha<sp/>nem<sp/>lennének<sp/>meg<sp/>máshol<sp/>(pl.<sp/>config.h)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Fontos:<sp/>ezeknek<sp/>a<sp/>típusoknak<sp/>egyezniük<sp/>kell<sp/>a<sp/>config.h-ban<sp/>deklaráltakkal!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Ha<sp/>már<sp/>szerepelnek<sp/>a<sp/>config.h-ban,<sp/>akkor<sp/>ezeket<sp/>innen<sp/>törölni<sp/>kell,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">//<sp/>vagy<sp/>csak<sp/>az<sp/>extern<sp/>kulcsszót<sp/>meghagyni!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>alpha<sp/>turbulens<sp/>paraméter<sp/>kiszámolása<sp/>--&gt;<sp/>alfa<sp/>csökkentése<sp/>alpha_r-rel<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>calculate_turbulent_alpha(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alpha_r;</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>alpha_r<sp/>=<sp/>1.0<sp/>-<sp/>0.5<sp/>*<sp/>(1.0<sp/>-<sp/>disk_params-&gt;a_mod)<sp/>*<sp/>(tanh((r<sp/>-<sp/>disk_params-&gt;r_dze_i)<sp/>/<sp/>disk_params-&gt;Dr_dze_i)<sp/>+<sp/>tanh((disk_params-&gt;r_dze_o<sp/>-<sp/>r)<sp/>/<sp/>disk_params-&gt;Dr_dze_o));</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>alpha_r<sp/>*<sp/>disk_params-&gt;alpha_visc;</highlight></codeline>
<codeline lineno="25"><highlight class="normal">}</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>kiszamolja<sp/>az<sp/>adott<sp/>reszecskehez<sp/>tartozo<sp/>Stokes<sp/>szamot<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>St<sp/>=<sp/>rho_particle<sp/>*<sp/>radius_particle<sp/>*<sp/>PI<sp/>/<sp/>(2<sp/>*<sp/>sigma)<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Stokes_Number(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>pradius,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/>disk_t<sp/>*disk_params)<sp/>{<sp/></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/>in<sp/>the<sp/>Epstein<sp/>drag<sp/>regime<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>disk_params-&gt;PDENSITYDIMLESS<sp/>*<sp/>pradius<sp/>*<sp/>M_PI<sp/>/<sp/>(2.0<sp/>*<sp/>sigma);</highlight></codeline>
<codeline lineno="31"><highlight class="normal">}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>Lokalis<sp/>viszkozitas<sp/>erteke<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>visc(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>nu;</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cs,<sp/>H;</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>H<sp/>=<sp/>scale_height(r,disk_params);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>cs<sp/>=<sp/>c_sound(r,disk_params);</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/>nu<sp/>=<sp/>calculate_turbulent_alpha(r,<sp/>disk_params)<sp/>*<sp/>cs<sp/>*<sp/>H;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nu;</highlight></codeline>
<codeline lineno="43"><highlight class="normal">}</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>local<sp/>scale<sp/>height<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>scale_height(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(disk_params<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;ERROR<sp/>[scale_height]:<sp/>disk_params<sp/>is<sp/>NULL!\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0;<sp/></highlight><highlight class="comment">//<sp/>Vagy<sp/>valamilyen<sp/>hibakód/NaN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Itt<sp/>van<sp/>az<sp/>eredeti<sp/>számítás</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>calculated_result<sp/>=<sp/>pow(r,<sp/>1.<sp/>+<sp/>disk_params-&gt;FLIND)<sp/>*<sp/>disk_params-&gt;HASP;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>calculated_result;</highlight></codeline>
<codeline lineno="56"><highlight class="normal">}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>lokális<sp/>kepleri<sp/>sebesség<sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>v_kep(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sqrt(G_GRAV_CONST<sp/>*<sp/>disk_params-&gt;STAR_MASS<sp/>/<sp/>r);</highlight></codeline>
<codeline lineno="61"><highlight class="normal">}</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>lokalis<sp/>kepleri<sp/>korfrekvencia<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kep_freq(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sqrt(G_GRAV_CONST<sp/>*<sp/>disk_params-&gt;STAR_MASS<sp/>/<sp/>r<sp/>/<sp/>r<sp/>/<sp/>r);</highlight></codeline>
<codeline lineno="66"><highlight class="normal">}</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>local<sp/>sound<sp/>speed<sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c_sound(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kep_freq(r,disk_params)<sp/>*<sp/>scale_height(r,disk_params);</highlight></codeline>
<codeline lineno="71"><highlight class="normal">}</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>Suruseg<sp/>a<sp/>midplane-ben<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho_mp(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1.<sp/>/<sp/>sqrt(2.0<sp/>*<sp/>M_PI)<sp/>*<sp/>sigma<sp/>/<sp/>scale_height(r,disk_params);</highlight></codeline>
<codeline lineno="76"><highlight class="normal">}</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>local<sp/>pressure<sp/>of<sp/>the<sp/>gas<sp/>p<sp/>=<sp/>rho_gas<sp/>*<sp/>cs<sp/>*<sp/>cs<sp/>kepletbol!!<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>press(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rho_mp(sigma,<sp/>r,<sp/>disk_params)<sp/>*<sp/>c_sound(r,disk_params)<sp/>*<sp/>c_sound(r,<sp/>disk_params);</highlight></codeline>
<codeline lineno="81"><highlight class="normal">}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>a<sp/>nyomas<sp/>derivaltja<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>dpress(disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ptemp,<sp/>pvec[disk_params-&gt;NGRID<sp/>+<sp/>2];</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptemp<sp/>=<sp/>(disk_params-&gt;pressvec[i<sp/>+<sp/>1]<sp/>-<sp/>disk_params-&gt;pressvec[i<sp/>-<sp/>1])<sp/>/<sp/>(2.0<sp/>*<sp/>disk_params-&gt;DD);</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pvec[i]<sp/>=<sp/>ptemp;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disk_params-&gt;dpressvec[i]<sp/>=<sp/>pvec[i];</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal">}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>u_gas<sp/>kiszamolasahoz<sp/>eltarolt<sp/>koefficiens<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Coeff_3(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1.0<sp/>*<sp/>(3.0<sp/>/<sp/>(sigma<sp/>*<sp/>sqrt(r)));</highlight></codeline>
<codeline lineno="103"><highlight class="normal">}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>u_gas<sp/>=<sp/>-3/(Sigma*R^0.5)*(d/dR)(nu*Sigma*R^0.5)<sp/>kiszamolasa<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>u_gas(disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tempug;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Lokális<sp/>tömbök,<sp/>méret<sp/>NGRID-hez<sp/>igazítva<sp/>disk_params-ból</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ugvec[disk_params-&gt;NGRID<sp/>+<sp/>2];</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ugvectemp[disk_params-&gt;NGRID<sp/>+<sp/>1];<sp/></highlight><highlight class="comment">//<sp/>Eredeti<sp/>kód<sp/>NGRID+1-et<sp/>használt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Első<sp/>ciklus:<sp/>feltölti<sp/>a<sp/>lokális<sp/>ugvec<sp/>tömböt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>private(i)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID<sp/>+<sp/>1;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Használd<sp/>a<sp/>disk_params-&gt;NGRID-et</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Hozzáférés<sp/>a<sp/>disk_params<sp/>tagjaihoz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ugvec[i]<sp/>=<sp/>disk_params-&gt;sigmavec[i]<sp/>*<sp/>visc(disk_params-&gt;rvec[i],<sp/>disk_params)<sp/>*<sp/>sqrt(disk_params-&gt;rvec[i]);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Megjegyzés:<sp/>A<sp/>sqrt()<sp/>függvénynek<sp/>általában<sp/>csak<sp/>egy<sp/>double<sp/>paramétere<sp/>van.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ha<sp/>valami<sp/>komplexebb<sp/>számítást<sp/>akarsz,<sp/>akkor<sp/>lehet,<sp/>hogy<sp/>egy<sp/>saját</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>függvényt<sp/>hívsz,<sp/>amihez<sp/>disk_params<sp/>is<sp/>kell.<sp/>Ellenőrizd<sp/>a<sp/>sqrt<sp/>prototípusát!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Második<sp/>ciklus:<sp/>feltölti<sp/>a<sp/>lokális<sp/>ugvectemp<sp/>tömböt</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>private(i,<sp/>tempug)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Használd<sp/>a<sp/>disk_params-&gt;NGRID-et</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tempug<sp/>=<sp/>(ugvec[i<sp/>+<sp/>1]<sp/>-<sp/>ugvec[i<sp/>-<sp/>1])<sp/>/<sp/>(2.0<sp/>*<sp/>disk_params-&gt;DD);<sp/></highlight><highlight class="comment">//<sp/>Használd<sp/>a<sp/>disk_params-&gt;DD-t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Coeff_3<sp/>hívása,<sp/>ha<sp/>szükséges,<sp/>átadva<sp/>neki<sp/>a<sp/>disk_params-ot</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ugvectemp[i]<sp/>=<sp/>Coeff_3(disk_params-&gt;sigmavec[i],<sp/>disk_params-&gt;rvec[i])<sp/>*<sp/>tempug;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Harmadik<sp/>ciklus:<sp/>Az<sp/>eredményt<sp/>bemásolja<sp/>a<sp/>disk_params-&gt;ugvec-be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Használd<sp/>a<sp/>disk_params-&gt;NGRID-et</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disk_params-&gt;ugvec[i]<sp/>=<sp/>ugvectemp[i];<sp/></highlight><highlight class="comment">//<sp/>Így<sp/>éri<sp/>el<sp/>a<sp/>struktúrán<sp/>belüli<sp/>ugvec-et</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal">}</highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>GetMass(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>(*partmassind)[5],<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>indii,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>indio,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>indoi,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>indoo,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*massiout,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*massoout,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>simulation_options_t<sp/>*sim_opts)<sp/>{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Debug<sp/>üzenet<sp/>frissítve<sp/>az<sp/>indexekre</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>massitemp<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>massotemp<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sim_opts-&gt;dzone<sp/>(ez<sp/>helyettesíti<sp/>az<sp/>optdze-t):<sp/>1.0<sp/>=<sp/>dinamikus<sp/>DZE<sp/>(flag-elt),<sp/>0.0<sp/>=<sp/>fix<sp/>DZE<sp/>(nem<sp/>flag-elt)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(sim_opts-&gt;dzone<sp/>==<sp/>1.0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Dinamikus<sp/>DZE:<sp/>flag-ek<sp/>használatával<sp/>(partmassind[i][3]<sp/>és<sp/>[4])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>private(i)<sp/>reduction(+:massitemp,<sp/>massotemp)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>A<sp/>részecske<sp/>aktuális<sp/>grid<sp/>indexe<sp/>(partmassind[i][1]-ből)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>current_r_index<sp/>=<sp/>(int)partmassind[i][1];<sp/></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Belső<sp/>DZE<sp/>---</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ellenőrizzük,<sp/>hogy<sp/>a<sp/>részecske<sp/>grid<sp/>indexe<sp/>a<sp/>belső<sp/>DZE<sp/>tartományában<sp/>van-e</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((current_r_index<sp/>&gt;=<sp/>indii)<sp/>&amp;&amp;<sp/>(current_r_index<sp/>&lt;=<sp/>indio))<sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(partmassind[i][3]<sp/>==<sp/>0.0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Belső<sp/>DZE<sp/>flag<sp/>ellenőrzése</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>critical(inner_dze_update)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>partmassind[i][3]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>massitemp<sp/>=<sp/>massitemp<sp/>+<sp/>partmassind[i][0];<sp/></highlight><highlight class="comment">//<sp/>Tömeg<sp/>hozzáadása<sp/>a<sp/>[0]<sp/>indexről</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Külső<sp/>DZE<sp/>---</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ellenőrizzük,<sp/>hogy<sp/>a<sp/>részecske<sp/>grid<sp/>indexe<sp/>a<sp/>külső<sp/>DZE<sp/>tartományában<sp/>van-e</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((current_r_index<sp/>&gt;=<sp/>indoi)<sp/>&amp;&amp;<sp/>(current_r_index<sp/>&lt;=<sp/>indoo))<sp/>{</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(partmassind[i][4]<sp/>==<sp/>0.0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Külső<sp/>DZE<sp/>flag<sp/>ellenőrzése<sp/>(Flag[4])</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>critical(outer_dze_update)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>partmassind[i][4]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>massotemp<sp/>=<sp/>massotemp<sp/>+<sp/>partmassind[i][0];<sp/></highlight><highlight class="comment">//<sp/>Tömeg<sp/>hozzáadása<sp/>a<sp/>[0]<sp/>indexről</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>Fix<sp/>DZE<sp/>(sim_opts-&gt;dzone<sp/>==<sp/>0.0):<sp/>Nincsenek<sp/>flag-ek<sp/>a<sp/>tömeg<sp/>felhalmozáshoz</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>private(i)<sp/>reduction(+:massitemp,<sp/>massotemp)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>current_r_index<sp/>=<sp/>(int)partmassind[i][1];<sp/></highlight><highlight class="comment">//<sp/>A<sp/>részecske<sp/>grid<sp/>indexe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Belső<sp/>DZE<sp/>(Fix)<sp/>---</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Az<sp/>eredeti<sp/>kódod<sp/>else<sp/>ága<sp/>nem<sp/>tartalmazta<sp/>a<sp/>belső<sp/>DZE<sp/>gyűjtését.<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ha<sp/>szeretnéd,<sp/>akkor<sp/>ide<sp/>kell<sp/>tenni<sp/>a<sp/>logikát:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((current_r_index<sp/>&gt;=<sp/>indii)<sp/>&amp;&amp;<sp/>(current_r_index<sp/>&lt;=<sp/>indio))<sp/>{</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>critical(inner_dze_update_fixed)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>massitemp<sp/>=<sp/>massitemp<sp/>+<sp/>partmassind[i][0];<sp/></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>---<sp/>Külső<sp/>DZE<sp/>(Fix)<sp/>---</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((current_r_index<sp/>&gt;=<sp/>indoi)<sp/>&amp;&amp;<sp/>(current_r_index<sp/>&lt;=<sp/>indoo))<sp/>{</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>critical(outer_dze_update_fixed)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>massotemp<sp/>=<sp/>massotemp<sp/>+<sp/>partmassind[i][0];</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/>*massiout<sp/>=<sp/>massitemp;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>*massoout<sp/>=<sp/>massotemp;</highlight></codeline>
<codeline lineno="207"><highlight class="normal">}</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIRNSTIEL<sp/>EL<sp/>AL<sp/>2012<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight><highlight class="comment">//reprezentativ<sp/>reszecske<sp/>kezdeti<sp/>meretenek<sp/>meghatarozasa</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight><highlight class="comment">//<sp/>1.<sp/>radialis<sp/>drift<sp/>altal<sp/>meghatarozott<sp/>maximalis<sp/>meret<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--&gt;<sp/>kimenet<sp/>cm-ben!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a_drift(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigmad,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>p,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dp,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho_p,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Sigmad_cgs<sp/>=<sp/>sigmad<sp/>/<sp/>SDCONV;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>vkep<sp/>=<sp/>v_kep(r,disk_params);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>vkep2<sp/>=<sp/>vkep<sp/>*<sp/>vkep;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c_s<sp/>=<sp/>c_sound(r,disk_params);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>c_s2<sp/>=<sp/>c_s<sp/>*<sp/>c_s;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dlnPdlnr<sp/>=<sp/>r<sp/>/<sp/>p<sp/>*<sp/>dp;</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>s_drift<sp/>=<sp/><sp/>disk_params-&gt;fDrift<sp/>*<sp/>2.0<sp/>/<sp/>M_PI<sp/>*<sp/>Sigmad_cgs<sp/>/<sp/>rho_p<sp/>*<sp/>vkep2<sp/>/<sp/>c_s2<sp/>*<sp/>fabs(1.0<sp/>/<sp/>dlnPdlnr);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s_drift;</highlight></codeline>
<codeline lineno="225"><highlight class="normal">}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight><highlight class="comment">//<sp/>2.<sp/>a<sp/>kis<sp/>skalaju<sp/>turbulencia<sp/>altal<sp/>okozott<sp/>fragmentacio<sp/>szerinti<sp/>maximalis<sp/>meret<sp/>--&gt;<sp/>kimenet<sp/>cm-ben!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a_turb(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho_p,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>s_frag,<sp/>u_frag,<sp/>u_frag2,<sp/>Sigma_cgs,<sp/>c_s,<sp/>c_s2;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>u_frag<sp/>=<sp/>disk_params-&gt;uFrag<sp/>*<sp/>CMPSECTOAUPYRP2PI;<sp/></highlight><highlight class="comment">/*<sp/>cm/sec<sp/>--&gt;<sp/>AU<sp/>/<sp/>(yr/2pi)<sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>u_frag2<sp/>=<sp/>u_frag<sp/>*<sp/>u_frag;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>Sigma_cgs<sp/>=<sp/>sigma<sp/>/<sp/>SDCONV;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>c_s<sp/>=<sp/>c_sound(r,disk_params);<sp/></highlight><highlight class="comment">//<sp/>/<sp/>CMPSECTOAUPYRP2PI;<sp/>//<sp/>Komment<sp/>ki,<sp/>ha<sp/>a<sp/>c_sound<sp/>már<sp/>megfelelő<sp/>mértékegységben<sp/>van</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>c_s2<sp/>=<sp/>c_s<sp/>*<sp/>c_s;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>s_frag<sp/>=<sp/>disk_params-&gt;fFrag<sp/>*<sp/>2.0<sp/>/<sp/>(3.0<sp/>*<sp/>M_PI)<sp/>*<sp/>Sigma_cgs<sp/>/<sp/>(rho_p<sp/>*<sp/>calculate_turbulent_alpha(r,disk_params))<sp/>*<sp/>u_frag2<sp/>/<sp/>c_s2;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s_frag;</highlight></codeline>
<codeline lineno="241"><highlight class="normal">}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight><highlight class="comment">//<sp/>3.<sp/>radialis<sp/>drift<sp/>altal<sp/>okozott<sp/>fragmentacio<sp/>szerinti<sp/>maximalis<sp/>meret<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>--&gt;<sp/>kimenet<sp/>cm-ben!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a_df(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>p,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dp,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rho_p,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>u_frag,<sp/>vkep,<sp/>dlnPdlnr,<sp/>c_s,<sp/>c_s2,<sp/>s_df,<sp/>Sigma_cgs;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>u_frag<sp/>=<sp/>disk_params-&gt;uFrag<sp/>*<sp/>CMPSECTOAUPYRP2PI;<sp/></highlight><highlight class="comment">/*<sp/>cm/sec<sp/>--&gt;<sp/>AU<sp/>/<sp/>(yr/2pi)<sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>Sigma_cgs<sp/>=<sp/>sigma<sp/>/<sp/>SDCONV;</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>c_s<sp/>=<sp/>c_sound(r,disk_params);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>c_s2<sp/>=<sp/>c_s<sp/>*<sp/>c_s;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>dlnPdlnr<sp/>=<sp/>r<sp/>/<sp/>p<sp/>*<sp/>dp;</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>vkep<sp/>=<sp/>v_kep(r,disk_params);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>s_df<sp/>=<sp/>u_frag<sp/>*<sp/>vkep<sp/>/<sp/>fabs(dlnPdlnr<sp/>*<sp/>c_s2<sp/>*<sp/>0.5)<sp/>*<sp/>2.0<sp/>*<sp/>Sigma_cgs<sp/>/<sp/>(M_PI<sp/>*<sp/>rho_p);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s_df;</highlight></codeline>
<codeline lineno="258"><highlight class="normal">}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>a<sp/>reszecskek<sp/>novekedesenek<sp/>idoskalaja<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tauGr(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eps,</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>omega<sp/>=<sp/>kep_freq(r,disk_params);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>taugr<sp/>=<sp/>eps<sp/>/<sp/>omega;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>taugr;</highlight></codeline>
<codeline lineno="265"><highlight class="normal">}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>kiszamolja<sp/>az<sp/>adott<sp/>helyen<sp/>a<sp/>reszecske<sp/>meretet<sp/>--&gt;<sp/>BIRNSTIEL<sp/>CIKK<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>getSize(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>prad,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>pdens,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigmad,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>p,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dpress_val,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dt,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sturb<sp/>=<sp/>a_turb(sigma,<sp/>y,<sp/>pdens,<sp/>disk_params);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>cm-ben</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sdf<sp/>=<sp/>a_df(sigma,<sp/>y,<sp/>p,<sp/>dpress_val,<sp/>pdens,disk_params);<sp/></highlight><highlight class="comment">//<sp/>cm-ben</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>srdf<sp/>=<sp/>a_drift(sigmad,<sp/>y,<sp/>p,<sp/>dpress_val,<sp/>pdens,<sp/>disk_params);<sp/></highlight><highlight class="comment">//<sp/>cm-ben</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>smin<sp/>=<sp/>find_min(sturb,<sp/>sdf,<sp/>srdf);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>cm-ben<sp/>--<sp/>megadja,<sp/>hogy<sp/>a<sp/>fenti<sp/>ket<sp/>reszecske<sp/>korlatbol<sp/>melyik<sp/>ad<sp/>kisebb<sp/>meretet<sp/>(az<sp/>a<sp/>reszecskenovekedes<sp/>felso<sp/>korlatja</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>double<sp/>eps<sp/>=<sp/>sigma<sp/>/<sp/>100.;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eps<sp/>=<sp/>sigmad<sp/>/<sp/>sigma;<sp/></highlight><highlight class="comment">//<sp/>A<sp/>korábbi<sp/>kódban<sp/>fordítva<sp/>volt,<sp/>feltételezem,<sp/>hogy<sp/>eps<sp/>=<sp/>(por<sp/>sűrűség)<sp/>/<sp/>(gáz<sp/>sűrűség)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tau_gr<sp/>=<sp/>tauGr(y,<sp/>eps,<sp/>disk_params);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rt<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/>smin<sp/>=<sp/>smin<sp/>/<sp/>AU2CM;<sp/></highlight><highlight class="comment">//<sp/>AU-ban</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/><sp/>kiszamolja,<sp/>hogy<sp/>a<sp/>fenti<sp/>smin,<sp/>vagy<sp/>a<sp/>novekedesi<sp/>idoskalabol<sp/>szarmazo<sp/>meret<sp/>korlatozza<sp/>a<sp/>reszecske<sp/>meretet<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prad<sp/>&lt;<sp/>smin)<sp/>{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rt<sp/>=<sp/>find_min(prad<sp/>*<sp/>exp(dt<sp/>/<sp/>tau_gr),<sp/>smin,<sp/>HUGE_VAL);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>prad<sp/>&gt;=<sp/>smin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rt<sp/>=<sp/>smin;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rt;</highlight></codeline>
<codeline lineno="289"><highlight class="normal">}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Get_Sigmad(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>max_param,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>min_param,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rad[][2],<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>radmicr[][2],<sp/></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*sigma_d,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*sigma_dm,<sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*massvec,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*massmicrvec,<sp/><sp/></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*rd,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*rmic,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>simulation_options_t<sp/>*sim_opts,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params)<sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Suppress<sp/>unused<sp/>parameter<sp/>warnings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)max_param;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>(void)min_param;</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dd<sp/>=<sp/>(disk_params-&gt;RMAX<sp/>-<sp/>disk_params-&gt;RMIN)<sp/>/<sp/>(<ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref><sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>A<sp/>temp<sp/>tömbök<sp/>deklarálását<sp/>érdemes<sp/>a<sp/>scope<sp/>tetejére<sp/>tenni</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigdtemp[<ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>][3];</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigdmicrtemp[<ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>][3];</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Inicializálás,<sp/>ha<sp/>szükséges<sp/>(bár<sp/>a<sp/>loadSigDust<sp/>valószínűleg<sp/>felülírja)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;<ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>;<sp/>i++){</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigdtemp[i][0]<sp/>=<sp/>0.0;<sp/>sigdtemp[i][1]<sp/>=<sp/>0.0;<sp/>sigdtemp[i][2]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigdmicrtemp[i][0]<sp/>=<sp/>0.0;<sp/>sigdmicrtemp[i][1]<sp/>=<sp/>0.0;<sp/>sigdmicrtemp[i][2]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rd[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmic[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_d[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_dm[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>loadSigDust<sp/>és<sp/>contract<sp/>függvények<sp/>hívásai:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ezek<sp/>valószínűleg<sp/>szekvenciálisak,<sp/>hacsak<sp/>a<sp/>függvények<sp/>belsejében<sp/>nincs<sp/>OpenMP.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ha<sp/>ezek<sp/>a<sp/>függvények<sp/>valamilyen<sp/>globális<sp/>állapotot<sp/>módosítanak,<sp/>akkor<sp/>kritikusak.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Feltételezve,<sp/>hogy<sp/>a<sp/>&apos;sigdtemp&apos;<sp/>és<sp/>&apos;sigdmicrtemp&apos;<sp/>kizárólagosan<sp/>a<sp/>hívásaikban<sp/>vannak<sp/>feldolgozva,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>és<sp/>nem<sp/>ütköznek<sp/>más<sp/>szálakkal<sp/>globális<sp/>adatokon<sp/>keresztül.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>loadSigDust(rad,<sp/>massvec,<sp/>sigdtemp,<sp/><ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>,disk_params);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sim_opts-&gt;twopop<sp/>==<sp/>1.0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Használjunk<sp/>double<sp/>összehasonlítást</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loadSigDust(radmicr,<sp/>massmicrvec,<sp/>sigdmicrtemp,<sp/><ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>,disk_params);</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>contract(sigdtemp,<sp/>dd,<sp/><ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>,disk_params);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sim_opts-&gt;twopop<sp/>==<sp/>1.0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Használjunk<sp/>double<sp/>összehasonlítást</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contract(sigdmicrtemp,<sp/>dd,<sp/><ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>,disk_params);</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Utolsó<sp/>másoló<sp/>ciklus:<sp/>Ez<sp/>is<sp/>jól<sp/>párhuzamosítható.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>private(i)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="config_8c_1ae28967b989638744a8c653fa8228c1b6" kindref="member">PARTICLE_NUMBER</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rd[i]<sp/>=<sp/>sigdtemp[i][1];</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_d[i]<sp/>=<sp/>sigdtemp[i][0];</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sim_opts-&gt;twopop<sp/>==<sp/>1.0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>double<sp/>összehasonlítás</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmic[i]<sp/>=<sp/>sigdmicrtemp[i][1];</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_dm[i]<sp/>=<sp/>sigdmicrtemp[i][0];</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="346"><highlight class="normal">}</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>Fuggveny<sp/>a<sp/>sigma,<sp/>p,<sp/>dp<sp/>kiszamolasara<sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Get_Sigma_P_dP(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>simulation_options_t<sp/>*sim_opts,<sp/>disk_t<sp/>*disk_params)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Added<sp/>sim_opts</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>u,<sp/>u_bi,<sp/>u_fi;</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma_temp[disk_params-&gt;NGRID<sp/>+<sp/>2];<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;NGRID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>uvec[disk_params-&gt;NGRID<sp/>+<sp/>2];<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;NGRID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Boundary<sp/>conditions<sp/>-<sp/>access<sp/>via<sp/>disk_params</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>sigma_temp[0]<sp/>=<sp/>disk_params-&gt;sigmavec[0];</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>sigma_temp[disk_params-&gt;NGRID<sp/>+<sp/>1]<sp/>=<sp/>disk_params-&gt;sigmavec[disk_params-&gt;NGRID<sp/>+<sp/>1];</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>uvec<sp/>temporary<sp/>array<sp/>initialization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>uvec[0]<sp/>=<sp/>disk_params-&gt;sigmavec[0]<sp/>*<sp/>visc(disk_params-&gt;rvec[0],<sp/>disk_params);<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;rvec</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>uvec[disk_params-&gt;NGRID<sp/>+<sp/>1]<sp/>=<sp/>disk_params-&gt;sigmavec[disk_params-&gt;NGRID<sp/>+<sp/>1]<sp/>*<sp/>visc(disk_params-&gt;rvec[disk_params-&gt;NGRID<sp/>+<sp/>1],<sp/>disk_params);<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;rvec</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;NGRID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uvec[i]<sp/>=<sp/>disk_params-&gt;sigmavec[i]<sp/>*<sp/>visc(disk_params-&gt;rvec[i],<sp/>disk_params);<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;sigmavec<sp/>and<sp/>disk_params-&gt;rvec</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>loop<sp/>is<sp/>critical<sp/>due<sp/>to<sp/>data<sp/>dependencies.<sp/>Keep<sp/>it<sp/>sequential<sp/>for<sp/>correctness</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;NGRID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u<sp/>=<sp/>uvec[i];</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_bi<sp/>=<sp/>uvec[i<sp/>-<sp/>1];</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>u_fi<sp/>=<sp/>uvec[i<sp/>+<sp/>1];</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Access<sp/>DD<sp/>and<sp/>deltat<sp/>through<sp/>the<sp/>appropriate<sp/>structs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Assuming<sp/>Coeff_1<sp/>and<sp/>Coeff_2<sp/>also<sp/>take<sp/>disk_params<sp/>(and<sp/>sim_opts<sp/>if<sp/>they<sp/>need<sp/>it)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>temp<sp/>=<sp/>Coeff_1(disk_params-&gt;rvec[i],<sp/>disk_params)<sp/>*<sp/>(u_fi<sp/>-<sp/>2.0<sp/>*<sp/>u<sp/>+<sp/>u_bi)<sp/>/<sp/>(disk_params-&gt;DD<sp/>*<sp/>disk_params-&gt;DD)<sp/>+</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Coeff_2(disk_params-&gt;rvec[i],<sp/>disk_params)<sp/>*<sp/>(u_fi<sp/>-<sp/>u_bi)<sp/>/<sp/>(2.0<sp/>*<sp/>disk_params-&gt;DD);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sigma_temp[i]<sp/>=<sp/>uvec[i]<sp/>+<sp/>sim_opts-&gt;DT<sp/>*<sp/>temp;<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>sim_opts-&gt;DT<sp/>for<sp/>deltat</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>loop<sp/>is<sp/>parallelizable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>disk_params-&gt;NGRID;<sp/>i++)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Use<sp/>disk_params-&gt;NGRID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Update<sp/>disk_params&apos;<sp/>own<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disk_params-&gt;sigmavec[i]<sp/>=<sp/>sigma_temp[i]<sp/>/<sp/>visc(disk_params-&gt;rvec[i],<sp/>disk_params);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disk_params-&gt;pressvec[i]<sp/>=<sp/>press(disk_params-&gt;sigmavec[i],<sp/>disk_params-&gt;rvec[i],<sp/>disk_params);<sp/></highlight><highlight class="comment">//<sp/>Assuming<sp/>press<sp/>takes<sp/>disk_params</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>These<sp/>calls<sp/>likely<sp/>remain<sp/>sequential<sp/>or<sp/>require<sp/>their<sp/>own<sp/>internal<sp/>OpenMP<sp/>if<sp/>large</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>Perem,<sp/>dpress<sp/>also<sp/>update<sp/>members<sp/>of<sp/>disk_params,<sp/>they<sp/>should<sp/>take<sp/>disk_params<sp/>as<sp/>a<sp/>parameter.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>And<sp/>if<sp/>they<sp/>are<sp/>modifying<sp/>the<sp/>*content*<sp/>of<sp/>the<sp/>arrays<sp/>within<sp/>disk_params,<sp/>then<sp/>disk_params<sp/>should<sp/>NOT<sp/>be<sp/>const<sp/>in<sp/>*their*<sp/>parameter<sp/>list.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>However,<sp/>since<sp/>Get_Sigma_P_dP<sp/>is<sp/>modifying<sp/>them,<sp/>disk_params<sp/>*here*<sp/>cannot<sp/>be<sp/>const.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Let&apos;s<sp/>remove<sp/>&apos;const&apos;<sp/>from<sp/>disk_params<sp/>in<sp/>Get_Sigma_P_dP<sp/>signature<sp/>if<sp/>it<sp/>modifies<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>void<sp/>Get_Sigma_P_dP(disk_t<sp/>*disk_params,<sp/>const<sp/>simulation_options_t<sp/>*sim_opts)<sp/>{<sp/>...<sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Assuming<sp/>these<sp/>helper<sp/>functions<sp/>need<sp/>disk_params<sp/>to<sp/>access<sp/>*its*<sp/>internal<sp/>arrays</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>dpress(disk_params);<sp/></highlight><highlight class="comment">//<sp/>Assuming<sp/>dpress<sp/>takes<sp/>arrays<sp/>and<sp/>disk_params</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>Perem(disk_params-&gt;sigmavec,<sp/>disk_params);<sp/></highlight><highlight class="comment">//<sp/>First<sp/>argument<sp/>is<sp/>the<sp/>array,<sp/>second<sp/>is<sp/>the<sp/>disk_t<sp/>pointer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>Perem(disk_params-&gt;pressvec,<sp/>disk_params);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/>Perem(disk_params-&gt;dpressvec,<sp/>disk_params);</highlight></codeline>
<codeline lineno="405"><highlight class="normal">}</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight><highlight class="comment">/*<sp/><sp/>Fuggveny<sp/>a<sp/>porszemcsek<sp/>uj<sp/>tavolsaganak<sp/>elraktarozasara<sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Get_Radius(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*nev,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>opt,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>radius[][2],<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*sigmad,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*rdvec,</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>deltat,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>simulation_options_t<sp/>*sim_opts,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>disk_t<sp/>*disk_params){</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y,<sp/>y_out,<sp/>prad_new,<sp/>particle_radius;</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timescale_out[1024];</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fájlkezelés<sp/>t==0<sp/>esetén:<sp/>ez<sp/>valószínűleg<sp/>egyszer<sp/>történik<sp/>meg<sp/>a<sp/>szimuláció<sp/>elején,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>még<sp/>mielőtt<sp/>az<sp/>igazi<sp/>párhuzamosítás<sp/>elkezdődne<sp/>a<sp/>fő<sp/>ciklusban.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Biztosítjuk,<sp/>hogy<sp/>csak<sp/>egy<sp/>szál<sp/>nyissa<sp/>meg/zárja<sp/>be<sp/>a<sp/>fájlt.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>master</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(t<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sprintf(timescale_out,<sp/></highlight><highlight class="stringliteral">&quot;%s/%s&quot;</highlight><highlight class="normal">,<sp/>nev,<ref refid="config_8c_1a6867b0ab2a90d40b0dec51d37d55534e" kindref="member">FILE_TIMESCALE</ref>);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="config_8c_1a2e733ed423cc165ef1f4d6727bd72e2c" kindref="member">timescale_output_file</ref><sp/>=<sp/>fopen(timescale_out,<sp/></highlight><highlight class="stringliteral">&quot;w&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Szinkronizálás<sp/>a<sp/>master<sp/>szál<sp/>befejezéséig.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>barrier</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>**ITT<sp/>A<sp/>PÁRHUZAMOSÍTÁS!**</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Az<sp/>`i`<sp/>ciklus<sp/>független<sp/>iterációkkal<sp/>rendelkezik,<sp/>minden<sp/>szál<sp/>a<sp/>saját<sp/>`radius[i]`<sp/>elemen<sp/>dolgozik.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>parallel<sp/>for<sp/>private(y,<sp/>y_out,<sp/>prad_new,<sp/>particle_radius)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Csak<sp/>a<sp/>RMIN<sp/>és<sp/>RMAX<sp/>közötti<sp/>részecskékkel<sp/>foglalkozunk.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>A<sp/>0.0-ra<sp/>állítás<sp/>kívül<sp/>esik<sp/>a<sp/>párhuzamos<sp/>részen,<sp/>ha<sp/>az<sp/>if<sp/>feltétel<sp/>nem<sp/>teljesül.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(radius[i][0]<sp/>&gt;<sp/>disk_params-&gt;RMIN<sp/>&amp;&amp;<sp/>radius[i][0]<sp/>&lt;<sp/>disk_params-&gt;RMAX)<sp/>{</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>=<sp/>radius[i][0];</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>particle_radius<sp/>=<sp/>radius[i][1];</highlight></codeline>
<codeline lineno="437"><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_step(t,<sp/>particle_radius,<sp/>sigmad,<sp/>rdvec,<sp/>deltat,<sp/>y,<sp/>&amp;y_out,<sp/>&amp;prad_new,<sp/>disk_params,<sp/>sim_opts);</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(t<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sim_opts-&gt;twopop<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>current_drdt_val<sp/>=<sp/>(fabs(y_out<sp/>-<sp/>y)<sp/>/<sp/>(deltat));</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Azért<sp/>kell<sp/>a<sp/>critical<sp/>szekció,<sp/>mert<sp/>az<sp/>timescale_output_file<sp/>fájlba<sp/>írunk.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ez<sp/>a<sp/>critical<sp/>szekció<sp/>biztosítja,<sp/>hogy<sp/>egyszerre<sp/>csak<sp/>egy<sp/>szál<sp/>írjon<sp/>a<sp/>fájlba.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>critical(timescale_output_file_write)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ellenőrizzük,<sp/>hogy<sp/>a<sp/>fájlmutató<sp/>nem<sp/>NULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="config_8c_1a2e733ed423cc165ef1f4d6727bd72e2c" kindref="member">timescale_output_file</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(<ref refid="config_8c_1a2e733ed423cc165ef1f4d6727bd72e2c" kindref="member">timescale_output_file</ref>,<sp/></highlight><highlight class="stringliteral">&quot;%lg<sp/>%lg\n&quot;</highlight><highlight class="normal">,<sp/>radius[i][0],<sp/>(radius[i][0]<sp/>/<sp/>current_drdt_val)<sp/>/<sp/>(2.0<sp/>*<sp/>M_PI));</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;ERROR:<sp/>timescale_output_file<sp/>is<sp/>NULL<sp/>during<sp/>write<sp/>in<sp/>Get_Radius<sp/>(t=0<sp/>block).\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sim_opts-&gt;twopop<sp/>!=<sp/>1)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Ha<sp/>növekedés<sp/>engedélyezett<sp/>vagy<sp/>valami<sp/>más<sp/>mód</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radius[i][1]<sp/>=<sp/>prad_new;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radius[i][0]<sp/>=<sp/>y_out;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>sim_opts-&gt;twopop<sp/>==<sp/>1,<sp/>csak<sp/>drift</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radius[i][0]<sp/>=<sp/>y_out;</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ha<sp/>a<sp/>részecske<sp/>RMIN<sp/>vagy<sp/>RMAX<sp/>kívülre<sp/>kerül,<sp/>0.0-ra<sp/>állítjuk<sp/>a<sp/>pozícióját.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ez<sp/>a<sp/>hozzárendelés<sp/>iterációnként<sp/>független,<sp/>így<sp/>párhuzamosítható.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>radius[i][0]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>A<sp/>fájl<sp/>bezárása<sp/>ismételten<sp/>egy<sp/>szál<sp/>által<sp/>kell,<sp/>hogy<sp/>történjen.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>master</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(t<sp/>==<sp/>0)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Csak<sp/>akkor<sp/>zárjuk<sp/>be,<sp/>ha<sp/>meg<sp/>is<sp/>nyitottuk<sp/>a<sp/>t=0<sp/>blokkban</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="config_8c_1a2e733ed423cc165ef1f4d6727bd72e2c" kindref="member">timescale_output_file</ref><sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fclose(<ref refid="config_8c_1a2e733ed423cc165ef1f4d6727bd72e2c" kindref="member">timescale_output_file</ref>);</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="config_8c_1a2e733ed423cc165ef1f4d6727bd72e2c" kindref="member">timescale_output_file</ref><sp/>=<sp/>NULL;<sp/></highlight><highlight class="comment">//<sp/>Fontos,<sp/>hogy<sp/>NULL-ra<sp/>állítsuk,<sp/>miután<sp/>bezártuk.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Szinkronizálás<sp/>a<sp/>master<sp/>szál<sp/>befejezéséig.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#pragma<sp/>omp<sp/>barrier</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/Users/tnehezd/Documents/Munka/dust_drift/src/dust_physics.c"/>
  </compounddef>
</doxygen>
